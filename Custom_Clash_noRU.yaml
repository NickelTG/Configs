# --- ГЛОБАЛЬНЫЕ НАСТРОЙКИ ---
unified-delay: true
tcp-concurrent: true
global-client-fingerprint: chrome
keep-alive-interval: 1800

# --- ГРУППЫ ПРОКСИ ---
proxy-groups:
  - name: VPN
    type: select
    proxies:      
      - BALANCE-HASH    
      - BALANCE-RR
      - auto
      - FALLBACK
      - DIRECT

  - name: auto
    type: url-test
    url: http://cp.cloudflare.com/generate_204
    interval: 300
    tolerance: 150
    lazy: true
    use: &all_providers
      - sweden_Soli
#     - lithuania_Soli
      - estonia_Soli
      - switzerland_Soli
      - netherlands_Soli
      - latvia_Force
      - austria_Force
      - finland_Force
      - poland_Force
#      - austria_danial
      - belgium_danial
#      - bulgaria_danial
#      - switzerland_danial
#      - czech_danial
#      - germany_danial
#      - denmark_danial
#      - spain_danial
#      - finland_danial
#      - france_danial
#      - united_kingdom_danial
#      - greece_danial
#      - hungary_danial
#      - ireland_danial
#      - italy_danial
#      - luxembourg_danial
#      - latvia_danial
#      - moldova_danial
#      - netherlands_danial
#      - norway_danial
#      - poland_danial
#      - portugal_danial
#      - romania_danial
#      - serbia_danial
#      - sweden_danial

  - name: FALLBACK
    type: fallback
    url: http://cp.cloudflare.com/generate_204
    interval: 300
    use: *all_providers

  - name: BALANCE-HASH
    type: load-balance
    url: http://cp.cloudflare.com/generate_204
    interval: 300
    strategy: consistent-hashing
    use: *all_providers

  - name: BALANCE-RR
    type: load-balance
    url: http://cp.cloudflare.com/generate_204
    interval: 300
    strategy: round-robin
    use: *all_providers

# --- ПРОВАЙДЕРЫ ПРОКСИ ---
common-settings: &common_settings
  type: http
  health-check: {enable: true, url: http://cp.cloudflare.com/generate_204, interval: 300}
  override: {udp: true}
  interval: 43200

proxy-providers:
  sweden_Soli: { <<: *common_settings, url: "https://raw.githubusercontent.com/SoliSpirit/v2ray-configs/refs/heads/main/Countries/Sweden.txt", path: ./pp/se_soli.yml }
#  lithuania_Soli: { <<: *common_settings, url: "https://raw.githubusercontent.com/SoliSpirit/v2ray-configs/refs/heads/main/Countries/Lithuania.txt", path: ./pp/lt_soli.yml }
  estonia_Soli: { <<: *common_settings, url: "https://raw.githubusercontent.com/SoliSpirit/v2ray-configs/refs/heads/main/Countries/Estonia.txt", path: ./pp/ee_soli.yml }
  switzerland_Soli: { <<: *common_settings, url: "https://raw.githubusercontent.com/SoliSpirit/v2ray-configs/refs/heads/main/Countries/Switzerland.txt", path: ./pp/ch_soli.yml }
  netherlands_Soli: { <<: *common_settings, url: "https://raw.githubusercontent.com/SoliSpirit/v2ray-configs/refs/heads/main/Countries/The_Netherlands.txt", path: ./pp/nl_soli.yml }
  latvia_Force: { <<: *common_settings, url: "https://raw.githubusercontent.com/F0rc3Run/F0rc3Run/refs/heads/main/splitted-by-country/Latvia.txt", path: ./pp/lv_force.yml }
  austria_Force: { <<: *common_settings, url: "https://raw.githubusercontent.com/F0rc3Run/F0rc3Run/refs/heads/main/splitted-by-country/Austria.txt", path: ./pp/at_force.yml }
  finland_Force: { <<: *common_settings, url: "https://raw.githubusercontent.com/F0rc3Run/F0rc3Run/refs/heads/main/splitted-by-country/Finland.txt", path: ./pp/fi_force.yml }
  poland_Force: { <<: *common_settings, url: "https://raw.githubusercontent.com/F0rc3Run/F0rc3Run/refs/heads/main/splitted-by-country/Poland.txt", path: ./pp/pl_force.yml }
#  austria_danial: { <<: *common_settings, url: "https://raw.githubusercontent.com/Danialsamadi/v2go/main/Splitted-By-Country/AT.txt", path: ./pp/at_danial.yml }
  belgium_danial: { <<: *common_settings, url: "https://raw.githubusercontent.com/Danialsamadi/v2go/main/Splitted-By-Country/BE.txt", path: ./pp/be_danial.yml }
#  bulgaria_danial: { <<: *common_settings, url: "https://raw.githubusercontent.com/Danialsamadi/v2go/main/Splitted-By-Country/BG.txt", path: ./pp/bg_danial.yml }
#  switzerland_danial: { <<: *common_settings, url: "https://raw.githubusercontent.com/Danialsamadi/v2go/main/Splitted-By-Country/CH.txt", path: ./pp/ch_danial.yml }
#  czech_danial: { <<: *common_settings, url: "https://raw.githubusercontent.com/Danialsamadi/v2go/main/Splitted-By-Country/CZ.txt", path: ./pp/cz_danial.yml }

# --- ПРОВАЙДЕРЫ ПРАВИЛ ---
rule-providers:
  skrepysh-proxy:
    type: http
    behavior: classical
    url: https://github.com/Skrepysh/mihomo-rulesets/raw/refs/heads/main/skrepysh-rulesets/skrepysh-proxy.yaml
    interval: 86400
  ru-bundle:
    type: http
    behavior: domain
    url: https://github.com/legiz-ru/mihomo-rule-sets/raw/main/ru-bundle/rule.yaml
    interval: 86400
  torrent-clients:
    type: http
    behavior: classical
    url: 'https://raw.githubusercontent.com/legiz-ru/mihomo-rule-sets/refs/heads/main/other/torrent-clients.yaml'
    interval: 86400
  torrent-trackers:
    type: http
    behavior: domain
    url: https://github.com/legiz-ru/mihomo-rule-sets/raw/main/other/torrent-trackers.mrs
    interval: 86400


# --- ПРАВИЛА МАРШРУТИЗАЦИИ ---
rules:
  
  # Торренты
  - RULE-SET,torrent-clients,DIRECT
  - RULE-SET,torrent-trackers,DIRECT
    
  # Всякое
  - PROCESS-NAME,com.badoo.mobile,VPN
  - PROCESS-NAME,com.bumble.app,VPN
#  - PROCESS-NAME,com.whatsapp,VPN
  - PROCESS-NAME,com.facebook.lite,VPN
  - PROCESS-NAME,ru.fourpda.client,VPN
  
  # Заблокированные в РФ сайты
  - RULE-SET,ru-bundle,VPN
  
  # Инструменты проверки IP
  - OR,((DOMAIN,ipwho.is),(DOMAIN,api.ip.sb),(DOMAIN,ipapi.co),(DOMAIN,ipinfo.io)),VPN
  
  # Блокировка рекламы
#  - RULE-SET,oisd_big,REJECT
  
  # Весь остальной трафик - напрямую
  - MATCH,DIRECT
